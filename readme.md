Ugly code found from old archives. Nice outcome, still.
